INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('acura','rapido',164000,1,1,1,0.0,1,NULL,255000,164000,164000,NULL,1,164000,164000.00,164000,164000),
	 ('acura','rsx',255000,2,2,2,0.33,1,164000,404000,164000,255000,255000,2,419000,209500.00,255000,164000),
	 ('acura','ssx',404000,3,3,3,0.67,2,255000,625000,164000,404000,255000,3,823000,274333.33,404000,164000),
	 ('acura','lightning',625000,4,4,4,1.0,3,404000,NULL,164000,625000,255000,4,1448000,362000.00,625000,164000),
	 ('audi','A3',175000,1,1,1,0.0,1,NULL,225000,175000,175000,NULL,1,175000,175000.00,175000,175000),
	 ('audi','a4',225000,2,2,2,0.33,1,175000,275000,175000,225000,225000,2,400000,200000.00,225000,175000),
	 ('audi','A8',275000,3,3,3,0.67,2,225000,365000,175000,275000,225000,3,675000,225000.00,275000,175000),
	 ('audi','Q7',365000,4,4,4,1.0,3,275000,NULL,175000,365000,225000,4,1040000,260000.00,365000,175000),
	 ('bmw','3',171000,1,1,1,0.0,1,NULL,175000,171000,171000,NULL,1,171000,171000.00,171000,171000),
	 ('bmw','4',175000,2,2,2,0.2,1,171000,205000,171000,175000,175000,2,346000,173000.00,175000,171000);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('bmw','6',205000,3,3,3,0.4,2,175000,254000,171000,205000,175000,3,551000,183666.67,205000,171000),
	 ('bmw','X5',254000,4,4,4,0.6,2,205000,315000,171000,254000,175000,4,805000,201250.00,254000,171000),
	 ('bmw','X7',315000,5,5,5,0.8,3,254000,350000,171000,315000,175000,5,1120000,224000.00,315000,171000),
	 ('bmw','Z4',350000,6,6,6,1.0,3,315000,NULL,171000,350000,175000,6,1470000,245000.00,350000,171000),
	 ('dodge','ram',215000,1,1,1,0.0,1,NULL,275000,215000,215000,NULL,1,215000,215000.00,215000,215000),
	 ('dodge','demon',275000,2,2,2,1.0,2,215000,NULL,215000,275000,275000,2,490000,245000.00,275000,215000),
	 ('fiat','panda',58500,1,1,1,0.0,1,NULL,120000,58500,58500,NULL,1,58500,58500.00,58500,58500),
	 ('fiat','tipo',120000,2,2,2,0.25,1,58500,130000,58500,120000,120000,2,178500,89250.00,120000,58500),
	 ('fiat','bravo',130000,3,3,3,0.5,2,120000,154000,58500,130000,120000,3,308500,102833.33,130000,58500),
	 ('fiat','600',154000,4,4,4,0.75,2,130000,199000,58500,154000,120000,4,462500,115625.00,154000,58500);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('fiat','croma',199000,5,5,5,1.0,3,154000,NULL,58500,199000,120000,5,661500,132300.00,199000,58500),
	 ('ford','mustang',125000,1,1,1,0.0,1,NULL,134000,125000,125000,NULL,1,125000,125000.00,125000,125000),
	 ('ford','puma',134000,2,2,2,0.25,1,125000,147000,125000,134000,134000,2,259000,129500.00,134000,125000),
	 ('ford','focus',147000,3,3,3,0.5,2,134000,190000,125000,147000,134000,3,406000,135333.33,147000,125000),
	 ('ford','mondeo',190000,4,4,4,0.75,2,147000,304000,125000,190000,134000,4,596000,149000.00,190000,125000),
	 ('ford','skyful',304000,5,5,5,1.0,3,190000,NULL,125000,304000,134000,5,900000,180000.00,304000,125000),
	 ('honda','jazz',110000,1,1,1,0.0,1,NULL,130000,110000,110000,NULL,1,110000,110000.00,110000,110000),
	 ('honda','civic',130000,2,2,2,0.33,1,110000,144000,110000,130000,130000,2,240000,120000.00,130000,110000),
	 ('honda','HR-V',144000,3,3,3,0.67,2,130000,170000,110000,144000,130000,3,384000,128000.00,144000,110000),
	 ('honda','CR-V',170000,4,4,4,1.0,3,144000,NULL,110000,170000,130000,4,554000,138500.00,170000,110000);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('hyundai','i10',60000,1,1,1,0.0,1,NULL,100000,60000,60000,NULL,1,60000,60000.00,60000,60000),
	 ('hyundai','elantra',100000,2,2,2,0.25,1,60000,125000,60000,100000,100000,2,160000,80000.00,100000,60000),
	 ('hyundai','i30',125000,3,3,3,0.5,2,100000,150000,60000,125000,100000,3,285000,95000.00,125000,60000),
	 ('hyundai','i40',150000,4,4,4,0.75,2,125000,279000,60000,150000,100000,4,435000,108750.00,150000,60000),
	 ('hyundai','Santa Fe',279000,5,5,5,1.0,3,150000,NULL,60000,279000,100000,5,714000,142800.00,279000,60000),
	 ('kia','picanto',70000,1,1,1,0.0,1,NULL,103000,70000,70000,NULL,1,70000,70000.00,70000,70000),
	 ('kia','venga',103000,2,2,2,0.17,1,70000,117000,70000,103000,103000,2,173000,86500.00,103000,70000),
	 ('kia','stonic',117000,3,3,3,0.33,1,103000,135000,70000,117000,103000,3,290000,96666.67,117000,70000),
	 ('kia','ceed',135000,4,4,4,0.5,2,117000,150000,70000,135000,103000,4,425000,106250.00,135000,70000),
	 ('kia','xceed',150000,5,5,5,0.67,2,135000,204000,70000,150000,103000,5,575000,115000.00,150000,70000);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('kia','EV6',204000,6,6,6,0.83,3,150000,265000,70000,204000,103000,6,779000,129833.33,204000,70000),
	 ('kia','optima',265000,7,7,7,1.0,3,204000,NULL,70000,265000,103000,7,1044000,149142.86,265000,70000),
	 ('opel','corsa',100000,1,1,1,0.0,1,NULL,100000,100000,100000,100000,4,400000,100000.00,100000,100000),
	 ('opel','astra',100000,2,1,1,0.0,1,100000,100000,100000,100000,100000,4,400000,100000.00,100000,100000),
	 ('opel','adam',100000,3,1,1,0.0,1,100000,100000,100000,100000,100000,4,400000,100000.00,100000,100000),
	 ('opel','mocca',100000,4,1,1,0.0,2,100000,155000,100000,100000,100000,4,400000,100000.00,100000,100000),
	 ('opel','omega',155000,5,5,2,0.57,2,100000,165000,100000,155000,100000,5,555000,111000.00,155000,100000),
	 ('opel','vectra',165000,6,6,3,0.71,2,155000,170000,100000,165000,100000,6,720000,120000.00,165000,100000),
	 ('opel','zafira',170000,7,7,4,0.86,3,165000,214000,100000,170000,100000,7,890000,127142.86,170000,100000),
	 ('opel','crossland',214000,8,8,5,1.0,3,170000,NULL,100000,214000,100000,8,1104000,138000.00,214000,100000);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('pontiac','gto',204000,1,1,1,0.0,1,NULL,NULL,204000,204000,NULL,1,204000,204000.00,204000,204000),
	 ('range','discovery',335000,1,1,1,0.0,1,NULL,NULL,335000,335000,NULL,1,335000,335000.00,335000,335000),
	 ('renault','clio',95000,1,1,1,0.0,1,NULL,120000,95000,95000,NULL,1,95000,95000.00,95000,95000),
	 ('renault','megane',120000,2,2,2,0.33,1,95000,130000,95000,120000,120000,2,215000,107500.00,120000,95000),
	 ('renault','captur',130000,3,3,3,0.67,2,120000,195000,95000,130000,120000,3,345000,115000.00,130000,95000),
	 ('renault','RS',195000,4,4,4,1.0,3,130000,NULL,95000,195000,120000,4,540000,135000.00,195000,95000),
	 ('toyota','aygo',79000,1,1,1,0.0,1,NULL,135000,79000,79000,NULL,1,79000,79000.00,79000,79000),
	 ('toyota','corolla',135000,2,2,2,0.25,1,79000,230000,79000,135000,135000,2,214000,107000.00,135000,79000),
	 ('toyota','camry',230000,3,3,3,0.5,2,135000,260000,79000,230000,135000,3,444000,148000.00,230000,79000),
	 ('toyota','RAV4',260000,4,4,4,0.75,2,230000,399000,79000,260000,135000,4,704000,176000.00,260000,79000);
INSERT INTO `select car_brand brand, car_model model, car_price, row_number () over (partition by car_brand order by car_price) roww,
rank () over (partition by car_brand order by car_price) rankk,
dense_rank () over (partition by car_brand order by car_price) densee,
round(percent_rank() over (partition by car_brand order by car_price),2) percentt,
ntile(3) over (partition by car_brand order by car_price) ntilee,
lag(car_price,1) over w as lagg,
lead(car_price,1) over w as leadd,
first_value(car_price) over w as pierwszy,
last_value (car_price) over w as lastt,
nth_value(car_price,2) over w as nthh,
count(car_price) over w as ilosc,
sum(car_price) over w as summ,
round(avg(car_price) over w,2) as avgg,
max(car_price) over w as maks,
min(car_price) over w as minn
from window_function wf 
window w as (partition by car_brand order by car_price)` (car_brand,car_model,car_price,roww,rankk,densee,percentt,ntilee,lagg,leadd,pierwszy,lastt,nthh,ilosc,summ,avgg,maks,minn) VALUES
	 ('toyota','supra',399000,5,5,5,1.0,3,260000,NULL,79000,399000,135000,5,1103000,220600.00,399000,79000);
